function [Y,Xf,Af] = NN50fit(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 27-Oct-2014 20:44:35.
% 
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-2.94419709373991;-4.93578418199331;-7.14722479715953;-9.17218483204502;-9.22675680067379;-9.99074323931212;-2.94419709373991;-3.12098866416227;-3.0921128887122;-3.13342526895758;-3.13324332635167;-3.13563842705319];
  x1_step1_gain = [0.328634422652795;0.187719394841059;0.132355358259004;0.105088624960608;0.104987518455396;0.0953759325227081;0.328634422652795;0.320043475892485;0.32260501637595;0.319566156134893;0.323599411788973;0.320434216422146];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.8209221646929006e-06;2.9378943746632433e-06;3.9844018112758679e-06;-6.173758601210808e-06;4.978370783322241e-06;-4.9524045740534148e-06;6.7708389021372688e-06;-9.2935741682560654e-06;-3.2836946987956549e-06;-4.8848798918266775e-06;4.5747709128537924e-06;-8.9091316759786269e-06;2.2995036852480785e-06;-4.0912644336524874e-06;3.737618557078873e-06;1.0086627208472121e-05;1.1090510640273732e-06;-6.2041091061397708e-06;-0.088704854992338114;-5.9723274622029833e-06;1.6952435959975473e-06;-2.691026968346438e-07;1.9548291290785705e-05;7.3299689986195086e-06;-6.2224092316745117e-07;-1.0111749101476126e-06;-2.6472156457569134e-06;-8.1886774533263915e-07;-4.0501863737370447e-07;-1.2614940205699389e-08;2.6609372899315218e-06;-5.236673171070737e-06;-6.3139540170083045e-08;-1.5059572892278921e-06;1.3648952870199633e-06;-2.5210793687685714e-06;4.941279741820259e-07;2.691062700122026e-07;4.9565095191099593e-07;-4.713854652988305e-08;1.9390049090112769e-06;3.0511854276630933e-06;-2.0870215432472904e-06;-5.8805919465009085e-06;2.7083925820712361e-06;6.1464772149662267e-06;-4.632201974154808e-06;-4.2021318279600503e-06;4.8123187517566363e-06;-3.0650955938625498e-06];
  IW1_1 = [5.9338096543890801e-07 -4.7622369452224787e-06 -5.8875205954385405e-07 -1.5955928697736813e-06 -1.151552785934577e-06 8.5204549291612724e-07 5.933809654389079e-07 -8.2800741672269292e-07 4.6099220425225565e-06 -3.4933234133874974e-07 -4.2557406630111338e-06 -1.1867764930292768e-06;9.5736689661699269e-07 -7.6834416102385905e-06 -9.4989857351192555e-07 -2.5743457945537117e-06 -1.8579269979784514e-06 1.3746988797654135e-06 9.5736689661699269e-07 -1.3359156051910952e-06 7.4376951957075804e-06 -5.6361635559796791e-07 -6.8662553475727354e-06 -1.9147572890735278e-06;1.2983905864136565e-06 -1.0420360556966345e-05 -1.2882619728363135e-06 -3.4913535817557764e-06 -2.5197392247382788e-06 1.8643804053448769e-06 1.2983905864136567e-06 -1.8117821427764298e-06 1.0087076807284564e-05 -7.643821486983023e-07 -9.3120843529764555e-06 -2.5968130396068481e-06;-2.0118327547675605e-06 1.6146160356748236e-05 1.9961386569129921e-06 5.4097892818726682e-06 3.9042903889126317e-06 -2.8888237428350018e-06 -2.0118327547675613e-06 2.8073237030164726e-06 -1.5629743220092473e-05 1.1843963016716856e-06 1.4428906406939066e-05 4.0237148943700976e-06;1.6222936525841609e-06 -1.3019876255125819e-05 -1.6096383058912539e-06 -4.3623242563333791e-06 -3.1483260794316703e-06 2.3294781438505493e-06 1.6222936525841609e-06 -2.2637584591384895e-06 1.2603449863676707e-05 -9.5506876699143318e-07 -1.163512387936044e-05 -3.2446271241621602e-06;-1.61383208588162e-06 1.2951967124556321e-05 1.6012427470098385e-06 4.3395712253803543e-06 3.1319050257577501e-06 -2.3173280410127514e-06 -1.6138320858816202e-06 2.2519511373515126e-06 -1.2537712731808246e-05 9.5008731489357238e-07 1.1574437346612257e-05 3.2277037830764116e-06;2.2064023511383462e-06 -1.7707697643956302e-05 -2.1891904383298139e-06 -5.9329841175822391e-06 -4.2818844969154886e-06 3.1682094226584572e-06 2.2064023511383466e-06 -3.0788273079317838e-06 1.7141336462662338e-05 -1.2989423489553501e-06 -1.5824363584441894e-05 -4.4128588661905538e-06;-3.028482035391447e-06 2.4305378344142096e-05 3.0048571789751044e-06 8.1435445097008304e-06 5.877264497262016e-06 -4.348647137567205e-06 -3.0284820353914474e-06 4.2259623342543189e-06 -2.3527997644763249e-05 1.7829129979085738e-06 2.1720336073434224e-05 6.0570384336423853e-06;-1.070052290052179e-06 8.5878092490190101e-06 1.0617049196164025e-06 2.8773551940685191e-06 2.0766114283810722e-06 -1.536505690166631e-06 -1.0700522900521792e-06 1.493157490451032e-06 -8.3131376321661703e-06 6.2995594858250856e-07 7.6744373382372051e-06 2.1401308416418248e-06;-1.5918279263826444e-06 1.277537059487589e-05 1.5794102394011947e-06 4.2804023581899692e-06 3.0892023572760336e-06 -2.2857319069330046e-06 -1.5918279263826444e-06 2.2212463985704258e-06 -1.2366764446961861e-05 9.3713313538098083e-07 1.1416623058809709e-05 3.1836949235827201e-06;1.4907732136071258e-06 -1.1964346124305432e-05 -1.4791438437867473e-06 -4.0086676922748651e-06 -2.8930891653237731e-06 2.1406257829585986e-06 1.4907732136071264e-06 -2.0802340355200277e-06 1.1581679699641659e-05 -8.776407016431587e-07 -1.0691856555783956e-05 -2.981583017247205e-06;-2.9032043798172029e-06 2.3299950286807111e-05 2.8805568004022991e-06 7.8066747014407838e-06 5.6341427263760371e-06 -4.1687588930330551e-06 -2.9032043798172042e-06 4.0511491279732087e-06 -2.2554727093662908e-05 1.7091601559732009e-06 2.082184212727313e-05 5.8064800460195936e-06;7.4933555288335845e-07 -6.0138657309759989e-06 -7.4349006091529544e-07 -2.0149525089200267e-06 -1.4542081623199224e-06 1.0759832511408919e-06 7.4933555288335814e-07 -1.0456273990138049e-06 5.8215188605965072e-06 -4.4114516299885839e-07 -5.3742502163175672e-06 -1.4986894954003061e-06;-1.3332137368696259e-06 1.0699837152508062e-05 1.322813471643519e-06 3.5849925311815421e-06 2.5873192413815583e-06 -1.9143835396365109e-06 -1.3332137368696259e-06 1.8603745795823654e-06 -1.0357614652270995e-05 7.8488306229585534e-07 9.5618367120759016e-06 2.6664601954920138e-06;1.2179717255776581e-06 -9.7749511307607262e-06 -1.2084704512201869e-06 -3.2751084238851426e-06 -2.3636732769153292e-06 1.7489056402519927e-06 1.2179717255776585e-06 -1.6995651736928259e-06 9.4623100900653655e-06 -7.1703835151423875e-07 -8.7353186080957526e-06 -2.435973343957193e-06;3.2869129604602576e-06 -2.637944088041498e-05 -3.2612721225985964e-06 -8.8384615186222089e-06 -6.3787919330690663e-06 4.7197323338127622e-06 3.2869129604602576e-06 -4.5865784384454303e-06 2.5535723596951087e-05 -1.9350551311680872e-06 -2.3573807952203194e-05 -6.5739066425750092e-06;3.6140467928425989e-07 -2.900488584301036e-06 -3.5858539722905355e-07 -9.718119775947644e-07 -7.0136487291669603e-07 5.189469264068765e-07 3.6140467928425989e-07 -5.0430629265590085e-07 2.807719651891963e-06 -2.127643965731059e-07 -2.5920019001386767e-06 -7.2281822766549953e-07;-2.021723024922876e-06 1.622553568547129e-05 2.0059517741888542e-06 5.4363840755887532e-06 3.9234840749662217e-06 -2.9030253442703945e-06 -2.0217230249228773e-06 2.821124646457409e-06 -1.5706579816594729e-05 1.1902188525506985e-06 1.4499839629667838e-05 4.043495677576576e-06;-0.032274488009305859 0.18114512862507673 0.042872589890070652 0.070532034016258752 0.044247092550366816 -0.028290189707199515 -0.032274488009305859 0.061433216774600202 -0.19578764251663142 -0.023527078650053324 0.1623160958340126 0.078548745868162712;-1.9461927139418831e-06 1.5619359800680858e-05 1.9310106666201524e-06 5.2332841593877736e-06 3.7769051591614724e-06 -2.7945701296086032e-06 -1.9461927139418844e-06 2.7157291887375028e-06 -1.5119791797961675e-05 1.1457530218449588e-06 1.3958134672469226e-05 3.8924332006526359e-06;5.5242629319199926e-07 -4.4335512195845327e-06 -5.4811687061305544e-07 -1.4854663459785219e-06 -1.0720735480463029e-06 7.9323800510446795e-07 5.5242629319199937e-07 -7.7085901737787875e-07 4.2917489677298648e-06 -3.2522170693367239e-07 -3.9620128993513957e-06 -1.1048661434558294e-06;-8.7692061249193041e-08 7.0378121036015975e-07 8.7007984168862624e-08 2.3580268976430318e-07 1.7018078327923279e-07 -1.2591847385923019e-07 -8.7692061249192936e-08 1.2236603684135221e-07 -6.8127154356421177e-07 5.1625641780454923e-08 6.2892929295273417e-07 1.7538627450480304e-07;6.3701703961773249e-06 -5.1124422407422815e-05 -6.3204776352347833e-06 -1.7129295801840929e-05 -1.2362356500644236e-05 9.1470319678167543e-06 6.3701703961773257e-06 -8.8889749924701692e-06 4.9489264595983111e-05 -3.7502141703715574e-06 -4.5686992361622343e-05 -1.2740497528495734e-05;2.3886051759049117e-06 -1.9169984194310013e-05 -2.3699719203565398e-06 -6.4229248820147606e-06 -4.6354788619381061e-06 3.4298374511775561e-06 2.3886051759049121e-06 -3.3330742446841943e-06 1.8556853394306224e-05 -1.4062078897191485e-06 -1.7131126015791043e-05 -4.7772689916546631e-06;-2.0276864479574676e-07 1.6273395814665123e-06 2.011868666978484e-07 5.452419655800693e-07 3.935057096690893e-07 -2.9115883392751592e-07 -2.0276864479574652e-07 2.8294460304324832e-07 -1.5752909174865501e-06 1.1937296567463927e-07 1.454260951127961e-06 4.0554226564419336e-07;-3.2950993508435603e-07 2.644514196615577e-06 3.26939460775528e-07 8.8604746977144923e-07 6.3946790670735957e-07 -4.73148738318969e-07 -3.2950993508435603e-07 4.5980017217705478e-07 -2.5599323230525384e-06 1.9398747859145938e-07 2.3632521291978468e-06 6.5902795656272712e-07;-8.6264388831128204e-07 6.9232328502591044e-06 8.5591448964986345e-07 2.3196369901722102e-06 1.674101513167688e-06 -1.2386845539463519e-06 -8.6264388831128182e-07 1.2037385415129064e-06 -6.7018008749308675e-06 5.0785149067532332e-07 6.1868999586995646e-06 1.725308947436004e-06;-2.6684310984169508e-07 2.1415754642729334e-06 2.6476149322991244e-07 7.175372792106332e-07 5.1785268573830255e-07 -3.8316441266605707e-07 -2.6684310984169534e-07 3.7235450221787492e-07 -2.0730795320803262e-06 1.5709457144984826e-07 1.9138043510034322e-06 5.3369276820666724e-07;-1.3198276930663994e-07 1.0592406177312317e-06 1.3095318480350265e-07 3.5489976585503876e-07 2.5613414418132154e-07 -1.8951623042914459e-07 -1.3198276930663983e-07 1.841695608650666e-07 -1.0253619733336181e-06 7.7700250986977753e-08 9.465831752388612e-07 2.6396877753810008e-07;-4.1108101931497189e-09 3.2991709080079062e-08 4.0787421700903272e-09 1.1053909405967858e-08 7.9776993337220216e-09 -5.902780006374445e-09 -4.1108101931496395e-09 5.7362496030716651e-09 -3.1936505605485972e-08 2.420096089321724e-09 2.94828164770602e-08 8.2217212674939042e-09;8.6711533823916216e-07 -6.9591189098064252e-06 -8.6035105813021075e-07 -2.3316606548632526e-06 -1.6827790931357937e-06 1.2451051826738085e-06 8.6711533823916237e-07 -1.2099780298614644e-06 6.7365391582044337e-06 -5.1048390133271758e-07 -6.2189692918182734e-06 -1.7342519568772177e-06;-1.7064662353541107e-06 1.3695411538747201e-05 1.693154267558553e-06 4.5886631173006863e-06 3.3116767371706346e-06 -2.4503429391181273e-06 -1.7064662353541116e-06 2.381213395362676e-06 -1.3257378896852931e-05 1.0046224345646355e-06 1.2238811391730311e-05 3.4129743565039108e-06;-2.0575179992078298e-08 1.6512811846710579e-07 2.041467505130648e-08 5.532636267741475e-08 3.9929500999068691e-08 -2.9544239548551067e-08 -2.0575179992078258e-08 2.8710731587458723e-08 -1.5984667748633038e-07 1.2112919423899168e-08 1.4756562020328524e-07 4.1150864908598298e-08;-4.9074387005271554e-07 3.9385129028578217e-06 4.8691562591533576e-07 1.319603198564683e-06 9.5236872039410242e-07 -7.0466719868786013e-07 -4.9074387005271565e-07 6.8478698807390268e-07 -3.8125439062272913e-06 2.8890833233660395e-07 3.5196252738578773e-06 9.8149978342131588e-07;4.4477622310979347e-07 -3.5695950593326058e-06 -4.4130656794229346e-07 -1.1959968581463918e-06 -8.6316098559785659e-07 6.3866149812724638e-07 4.4477622310979352e-07 -6.2064345319654649e-07 3.4554254934107369e-06 -2.6184648426531648e-07 -3.1899443516417335e-06 -8.8956336134827252e-07;-8.2154006342626578e-07 6.5933500852973767e-06 8.1513131163227135e-07 2.2091093970253469e-06 1.5943328201344963e-06 -1.1796628953611159e-06 -8.2154006342626578e-07 1.1463820137009969e-06 -6.3824690468437516e-06 4.8365304773634475e-07 5.8921024689811953e-06 1.6431002889611941e-06;1.6102068498893867e-07 -1.2922872488223671e-06 -1.5976457858008824e-07 -4.3298230292883197e-07 -3.1248696752488696e-07 2.3121225142716359e-07 1.6102068498893867e-07 -2.2468924542078828e-07 1.2509548646260646e-06 -9.4795310823288346e-08 -1.1548437124059072e-06 -3.2204532150364788e-07;8.769322563461495e-08 -7.0379055525101121e-07 -8.7009139470832511e-08 -2.358058207803475e-07 -1.7018304295999731e-07 1.2592014581976037e-07 8.7693225634615029e-08 -1.2236766163161988e-07 6.8128058956869013e-07 -5.162632727265445e-08 -6.289376439509498e-07 -1.7538860330395499e-07;1.6151697529078942e-07 -1.296270275068683e-06 -1.6025699738000682e-07 -4.3431682038277212e-07 -3.1345009998074041e-07 2.3192488282221605e-07 1.6151697529078953e-07 -2.2538177194546828e-07 1.2548104981815245e-06 -9.5087484380631981e-08 -1.1584031167240563e-06 -3.2303791429925782e-07;-1.5360962034282066e-08 1.2328090250247489e-07 1.5241132691190594e-08 4.1305405683540221e-08 2.981045848118396e-08 -2.2057058174624728e-08 -1.5360962034282069e-08 2.1434780063165625e-08 -1.1933789862960113e-07 9.0432305073758299e-09 1.101691402159606e-07 3.0722301033623776e-08;6.3186039869707641e-07 -5.0710573980243491e-06 -6.2693131861776387e-07 -1.6990635114961934e-06 -1.2262284177516563e-06 9.072987442639762e-07 6.3186039869707641e-07 -8.8170185254131314e-07 4.9088652134138379e-06 -3.7198576496757307e-07 -4.5317159606743285e-06 -1.2637363039319465e-06;9.9428486923701423e-07 -7.9797304072907592e-06 -9.8652855282792179e-07 -2.6736176909376127e-06 -1.9295723599225941e-06 1.4277100039462536e-06 9.9428486923701381e-07 -1.3874311694184774e-06 7.7245075221924843e-06 -5.8535052337864493e-07 -7.1310318162693982e-06 -1.988594140488164e-06;-6.8009434037224966e-07 5.4581636112316973e-06 6.7478899220877686e-07 1.8287638857546292e-06 1.3198342679721492e-06 -9.7655865468013934e-07 -6.8009434037224987e-07 9.4900778893685107e-07 -5.2835902609879084e-06 4.0038181487749003e-07 4.8776507957699346e-06 1.3602053711206067e-06;-1.9162990092198337e-06 1.5379444954691049e-05 1.901350159331407e-06 5.152900418754303e-06 3.7188915382059248e-06 -2.7516452677386229e-06 -1.9162990092198346e-06 2.6740153304349536e-06 -1.4887550363377722e-05 1.12815414790271e-06 1.3743736401863432e-05 3.8326450570761337e-06;8.8257951789192045e-07 -7.0832281929787068e-06 -8.7569460350934372e-07 -2.3732436106856232e-06 -1.712789861663009e-06 1.2673104522724142e-06 8.8257951789192035e-07 -1.231556840747725e-06 6.8566789431053128e-06 -5.1958789641318934e-07 -6.3298787087202986e-06 -1.7651806960269461e-06;2.0029426134003897e-06 -1.6074811658994337e-05 -1.9873178665618143e-06 -5.3858838199745371e-06 -3.8870376162015857e-06 2.8760582427115731e-06 2.0029426134003902e-06 -2.7949183454366748e-06 1.5560676531681323e-05 -1.1791625415309203e-06 -1.4365146128384272e-05 -4.0059343933396024e-06;-1.5094881806387245e-06 1.2114544923528551e-05 1.4977128170290908e-06 4.0589919694851961e-06 2.9294086193539572e-06 -2.1674989124277032e-06 -1.5094881806387247e-06 2.1063490143676747e-06 -1.1727074555397947e-05 8.8865848643864155e-07 1.0826080691411145e-05 3.0190134103372732e-06;-1.3693419159755264e-06 1.0989787382166591e-05 1.358659818797426e-06 3.6821406836485589e-06 2.6574318792748108e-06 -1.9662605858755379e-06 -1.3693419159755258e-06 1.9107880614434817e-06 -1.0638291143888036e-05 8.0615226554017235e-07 9.8209487630589385e-06 2.7387174408308973e-06;1.5681825447829255e-06 -1.2585602273902214e-05 -1.5559493130119989e-06 -4.2168202677520813e-06 -3.0433146282161821e-06 2.251779114490834e-06 1.568182544782926e-06 -2.1882514888565477e-06 1.2183065656587241e-05 -9.2321274218665468e-07 -1.1247037889206501e-05 -3.1364035800230012e-06;-9.9881775271541683e-07 8.0161095059480436e-06 9.9102607582125832e-07 2.6858065491386412e-06 1.9383691612649106e-06 -1.4342188457722446e-06 -9.9881775271541683e-07 1.3937563827705375e-06 -7.7597230756044863e-06 5.8801909997555543e-07 7.1635417503849859e-06 1.9976600188037317e-06];
  
  % Layer 2
  b2 = 0.19488171545538421;
  LW2_1 = [9.9115182674995633e-06 1.7808222952075421e-05 2.3067233217585453e-05 -3.5545460091228739e-05 2.8795824515727806e-05 -2.8810776825450083e-05 3.8909232980176617e-05 -5.1347527888951818e-05 -1.8562885221079723e-05 -2.7966550282654174e-05 2.6970097429523041e-05 -5.1130267007844139e-05 1.221576630497739e-05 -2.3961044051500671e-05 2.2271096569112757e-05 5.820657603552011e-05 5.6022933248938786e-06 -3.5698841108466719e-05 -0.34109583872651067 -3.4459809250956018e-05 9.7079827979367628e-06 -2.5407372277379924e-06 0.00010983476383523202 4.1943988229929151e-05 -3.986662826487691e-06 -6.2753257115744743e-06 -1.5730874617149704e-05 -7.067853983604315e-06 -3.186224505368718e-06 -1.1091328754465075e-06 1.4648218939046547e-05 -3.0279149528513153e-05 9.0273417241994997e-07 -9.5080133243099454e-06 7.0043001449755733e-06 -1.6133377373277178e-05 2.2439817719226104e-06 2.4282093571592132e-06 4.4500135584867932e-06 -2.8603462144221743e-07 1.0818960927341815e-05 1.8476016164000887e-05 -1.2313096675943684e-05 -3.3975602987209655e-05 1.6865930102118115e-05 3.5455468596647628e-05 -2.6222940824871179e-05 -2.5119324922443868e-05 2.7980954339378207e-05 -1.9034617460190245e-05];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 2.36261788857763;
  y1_step1_xoffset = 0.124235429239349;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
